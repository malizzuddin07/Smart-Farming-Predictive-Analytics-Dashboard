from __future__ import annotations

<<<<<<< HEAD
from typing import Union, Sequence, Literal

import torch
import torch.fft
from torch.fft import * # noqa: F403

from ._typing import Array
=======
from typing import TYPE_CHECKING
if TYPE_CHECKING:
    import torch
    array = torch.Tensor
    from typing import Union, Sequence, Literal

from torch.fft import * # noqa: F403
import torch.fft
>>>>>>> 20d02ed6152c8a0e77c5e3a017e93086bb18bf18

# Several torch fft functions do not map axes to dim

def fftn(
<<<<<<< HEAD
    x: Array,
=======
    x: array,
>>>>>>> 20d02ed6152c8a0e77c5e3a017e93086bb18bf18
    /,
    *,
    s: Sequence[int] = None,
    axes: Sequence[int] = None,
    norm: Literal["backward", "ortho", "forward"] = "backward",
    **kwargs,
<<<<<<< HEAD
) -> Array:
    return torch.fft.fftn(x, s=s, dim=axes, norm=norm, **kwargs)

def ifftn(
    x: Array,
=======
) -> array:
    return torch.fft.fftn(x, s=s, dim=axes, norm=norm, **kwargs)

def ifftn(
    x: array,
>>>>>>> 20d02ed6152c8a0e77c5e3a017e93086bb18bf18
    /,
    *,
    s: Sequence[int] = None,
    axes: Sequence[int] = None,
    norm: Literal["backward", "ortho", "forward"] = "backward",
    **kwargs,
<<<<<<< HEAD
) -> Array:
    return torch.fft.ifftn(x, s=s, dim=axes, norm=norm, **kwargs)

def rfftn(
    x: Array,
=======
) -> array:
    return torch.fft.ifftn(x, s=s, dim=axes, norm=norm, **kwargs)

def rfftn(
    x: array,
>>>>>>> 20d02ed6152c8a0e77c5e3a017e93086bb18bf18
    /,
    *,
    s: Sequence[int] = None,
    axes: Sequence[int] = None,
    norm: Literal["backward", "ortho", "forward"] = "backward",
    **kwargs,
<<<<<<< HEAD
) -> Array:
    return torch.fft.rfftn(x, s=s, dim=axes, norm=norm, **kwargs)

def irfftn(
    x: Array,
=======
) -> array:
    return torch.fft.rfftn(x, s=s, dim=axes, norm=norm, **kwargs)

def irfftn(
    x: array,
>>>>>>> 20d02ed6152c8a0e77c5e3a017e93086bb18bf18
    /,
    *,
    s: Sequence[int] = None,
    axes: Sequence[int] = None,
    norm: Literal["backward", "ortho", "forward"] = "backward",
    **kwargs,
<<<<<<< HEAD
) -> Array:
    return torch.fft.irfftn(x, s=s, dim=axes, norm=norm, **kwargs)

def fftshift(
    x: Array,
=======
) -> array:
    return torch.fft.irfftn(x, s=s, dim=axes, norm=norm, **kwargs)

def fftshift(
    x: array,
>>>>>>> 20d02ed6152c8a0e77c5e3a017e93086bb18bf18
    /,
    *,
    axes: Union[int, Sequence[int]] = None,
    **kwargs,
<<<<<<< HEAD
) -> Array:
    return torch.fft.fftshift(x, dim=axes, **kwargs)

def ifftshift(
    x: Array,
=======
) -> array:
    return torch.fft.fftshift(x, dim=axes, **kwargs)

def ifftshift(
    x: array,
>>>>>>> 20d02ed6152c8a0e77c5e3a017e93086bb18bf18
    /,
    *,
    axes: Union[int, Sequence[int]] = None,
    **kwargs,
<<<<<<< HEAD
) -> Array:
=======
) -> array:
>>>>>>> 20d02ed6152c8a0e77c5e3a017e93086bb18bf18
    return torch.fft.ifftshift(x, dim=axes, **kwargs)


__all__ = torch.fft.__all__ + [
    "fftn",
    "ifftn",
    "rfftn",
    "irfftn",
    "fftshift",
    "ifftshift",
]

_all_ignore = ['torch']
